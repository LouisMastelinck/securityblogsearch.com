---
layout: default
title: Submit a Blog Post
---

<div class="container">
    <div class="post">
        <h1>Submit a Blog Post</h1>
        
        <p>Use this form to prepare your blog post submission. Fill in the details below, and we'll generate the properly formatted markdown file for you to submit via pull request.</p>
        
        <form id="submitForm" class="submit-form">
            <div class="form-group">
                <label for="postTitle">Post Title <span class="required">*</span></label>
                <input type="text" id="postTitle" name="title" required placeholder="e.g., Advanced XSS Prevention Techniques">
            </div>
            
            <div class="form-group">
                <label for="postAuthor">Author Name <span class="required">*</span></label>
                <input type="text" id="postAuthor" name="author" required placeholder="e.g., Your Name">
            </div>
            
            <div class="form-group">
                <label for="postDate">Publication Date <span class="required">*</span></label>
                <input type="date" id="postDate" name="date" required>
            </div>
            
            <div class="form-group">
                <label for="postLink">Link to Original Article <span class="required">*</span></label>
                <input type="url" id="postLink" name="link" required placeholder="https://example.com/your-article">
            </div>
            
            <div class="form-group">
                <label for="postSummary">Summary <span class="required">*</span></label>
                <textarea id="postSummary" name="summary" required rows="4" placeholder="Brief summary of the blog post (1-3 sentences)"></textarea>
            </div>
            
            <div class="form-group">
                <label>Tags <span class="required">*</span> (minimum 1 tag)</label>
                <p class="help-text">Select from existing tags or create new ones. Click a tag to add/remove it.</p>
                
                <div id="existingTags" class="tags-container">
                    <p class="loading-text">Loading existing tags...</p>
                </div>
                
                <div class="tag-input-group">
                    <input type="text" id="newTagInput" placeholder="Type a new tag and press Enter" class="new-tag-input">
                    <button type="button" id="addTagBtn" class="btn-add-tag">Add New Tag</button>
                </div>
                
                <div class="selected-tags-section">
                    <label>Selected Tags:</label>
                    <div id="selectedTags" class="selected-tags">
                        <p class="no-tags-text">No tags selected yet</p>
                    </div>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn-submit">Generate Markdown</button>
                <button type="reset" class="btn-reset-form">Reset Form</button>
            </div>
        </form>
        
        <div id="outputSection" class="output-section" style="display: none;">
            <h2>Generated Markdown</h2>
            <p>Copy the content below and create a new file in the <code>_posts</code> directory:</p>
            
            <div class="output-info">
                <p><strong>Filename:</strong> <code id="generatedFilename"></code></p>
            </div>
            
            <pre id="markdownOutput" class="markdown-output"></pre>
            
            <div class="output-actions">
                <button id="copyBtn" class="btn-copy">Copy to Clipboard</button>
                <button id="newSubmissionBtn" class="btn-new">Submit Another Post</button>
            </div>
            
            <div class="next-steps">
                <h3>Next Steps</h3>
                <ol>
                    <li>Copy the generated markdown above</li>
                    <li>Fork the <a href="https://github.com/LouisMastelinck/securityblogsearch.com" target="_blank">repository on GitHub</a></li>
                    <li>Create a new file in the <code>_posts</code> directory with the filename shown above</li>
                    <li>Paste the markdown content into the file</li>
                    <li>Commit your changes and submit a pull request</li>
                </ol>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('submitForm');
    const existingTagsContainer = document.getElementById('existingTags');
    const selectedTagsContainer = document.getElementById('selectedTags');
    const newTagInput = document.getElementById('newTagInput');
    const addTagBtn = document.getElementById('addTagBtn');
    const outputSection = document.getElementById('outputSection');
    const markdownOutput = document.getElementById('markdownOutput');
    const generatedFilename = document.getElementById('generatedFilename');
    const copyBtn = document.getElementById('copyBtn');
    const newSubmissionBtn = document.getElementById('newSubmissionBtn');
    const postDate = document.getElementById('postDate');
    
    // Set default date to today
    const today = new Date().toISOString().split('T')[0];
    postDate.value = today;
    
    // Store selected tags
    let selectedTags = new Set();
    let allTags = new Set();
    
    // Fetch existing tags from posts
    function loadExistingTags() {
        const posts = document.querySelectorAll('.post-card');
        
        // If no posts on this page, fetch from site data via hidden data element
        // For now, we'll create a data element that Jekyll will populate
        const tagsData = document.getElementById('site-tags-data');
        
        if (tagsData && tagsData.textContent) {
            const tags = JSON.parse(tagsData.textContent);
            tags.forEach(tag => allTags.add(tag));
        } else {
            // Fallback: fetch from localStorage or default tags
            const defaultTags = ['web-security', 'malware', 'vulnerability', 'incident-response', 
                                'cloud-security', 'cryptography', 'authentication', 'authorization',
                                'sql-injection', 'xss', 'csrf', 'pentesting', 'red-team', 'blue-team',
                                'threat-intelligence', 'forensics', 'network-security', 'zero-day'];
            defaultTags.forEach(tag => allTags.add(tag));
        }
        
        displayExistingTags();
    }
    
    function displayExistingTags() {
        existingTagsContainer.innerHTML = '';
        
        if (allTags.size === 0) {
            existingTagsContainer.innerHTML = '<p class="no-tags-text">No existing tags found. Create your own below.</p>';
            return;
        }
        
        const sortedTags = Array.from(allTags).sort();
        sortedTags.forEach(tag => {
            const tagBtn = document.createElement('button');
            tagBtn.type = 'button';
            tagBtn.className = 'tag-button';
            tagBtn.textContent = tag;
            tagBtn.dataset.tag = tag;
            
            tagBtn.addEventListener('click', () => toggleTag(tag, tagBtn));
            existingTagsContainer.appendChild(tagBtn);
        });
    }
    
    function toggleTag(tag, button) {
        if (selectedTags.has(tag)) {
            selectedTags.delete(tag);
            button.classList.remove('selected');
        } else {
            selectedTags.add(tag);
            button.classList.add('selected');
        }
        updateSelectedTagsDisplay();
    }
    
    function addNewTag() {
        const newTag = newTagInput.value.trim().toLowerCase();
        
        if (!newTag) {
            alert('Please enter a tag name');
            return;
        }
        
        if (newTag.includes(' ')) {
            alert('Tags cannot contain spaces. Use hyphens instead (e.g., "web-security")');
            return;
        }
        
        if (!allTags.has(newTag)) {
            allTags.add(newTag);
            displayExistingTags();
        }
        
        // Automatically select the new tag
        selectedTags.add(newTag);
        updateSelectedTagsDisplay();
        
        // Update button state
        const buttons = existingTagsContainer.querySelectorAll('.tag-button');
        buttons.forEach(btn => {
            if (btn.dataset.tag === newTag) {
                btn.classList.add('selected');
            }
        });
        
        newTagInput.value = '';
    }
    
    function updateSelectedTagsDisplay() {
        selectedTagsContainer.innerHTML = '';
        
        if (selectedTags.size === 0) {
            selectedTagsContainer.innerHTML = '<p class="no-tags-text">No tags selected yet</p>';
            return;
        }
        
        const sortedSelectedTags = Array.from(selectedTags).sort();
        sortedSelectedTags.forEach(tag => {
            const tagSpan = document.createElement('span');
            tagSpan.className = 'selected-tag';
            tagSpan.innerHTML = `${tag} <button type="button" class="remove-tag" data-tag="${tag}">&times;</button>`;
            
            tagSpan.querySelector('.remove-tag').addEventListener('click', (e) => {
                const tagToRemove = e.target.dataset.tag;
                selectedTags.delete(tagToRemove);
                updateSelectedTagsDisplay();
                
                // Update existing tag button state
                const buttons = existingTagsContainer.querySelectorAll('.tag-button');
                buttons.forEach(btn => {
                    if (btn.dataset.tag === tagToRemove) {
                        btn.classList.remove('selected');
                    }
                });
            });
            
            selectedTagsContainer.appendChild(tagSpan);
        });
    }
    
    function generateSlug(title) {
        return title.toLowerCase()
            .replace(/[^a-z0-9\s-]/g, '')
            .replace(/\s+/g, '-')
            .replace(/-+/g, '-')
            .trim();
    }
    
    function generateMarkdown(formData) {
        const date = formData.get('date');
        const title = formData.get('title');
        const author = formData.get('author');
        const link = formData.get('link');
        const summary = formData.get('summary');
        const tagsArray = Array.from(selectedTags).sort();
        
        const slug = generateSlug(title);
        const filename = `${date}-${slug}.md`;
        
        const markdown = `---
layout: post
title: "${title}"
author: "${author}"
date: ${date}
tags: [${tagsArray.join(', ')}]
link: "${link}"
summary: "${summary}"
---
`;
        
        return { markdown, filename };
    }
    
    // Event listeners
    addTagBtn.addEventListener('click', addNewTag);
    
    newTagInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            e.preventDefault();
            addNewTag();
        }
    });
    
    form.addEventListener('submit', (e) => {
        e.preventDefault();
        
        if (selectedTags.size === 0) {
            alert('Please select at least one tag');
            return;
        }
        
        const formData = new FormData(form);
        const { markdown, filename } = generateMarkdown(formData);
        
        markdownOutput.textContent = markdown;
        generatedFilename.textContent = filename;
        
        form.style.display = 'none';
        outputSection.style.display = 'block';
        
        // Scroll to output
        outputSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
    
    form.addEventListener('reset', () => {
        selectedTags.clear();
        updateSelectedTagsDisplay();
        displayExistingTags();
    });
    
    copyBtn.addEventListener('click', () => {
        const text = markdownOutput.textContent;
        navigator.clipboard.writeText(text).then(() => {
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'Copied!';
            copyBtn.classList.add('success');
            
            setTimeout(() => {
                copyBtn.textContent = originalText;
                copyBtn.classList.remove('success');
            }, 2000);
        }).catch(err => {
            alert('Failed to copy to clipboard. Please copy manually.');
        });
    });
    
    newSubmissionBtn.addEventListener('click', () => {
        form.reset();
        selectedTags.clear();
        updateSelectedTagsDisplay();
        displayExistingTags();
        form.style.display = 'block';
        outputSection.style.display = 'none';
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
    
    // Initialize
    loadExistingTags();
});
</script>

<!-- Hidden data element for Jekyll to populate with all tags -->
<div id="site-tags-data" style="display: none;">
{% assign all_tags = site.posts | map: 'tags' | join: ',' | split: ',' | uniq | sort %}
{{ all_tags | jsonify }}
</div>
